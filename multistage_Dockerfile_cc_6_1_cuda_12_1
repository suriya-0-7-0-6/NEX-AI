FROM python:3.10-slim
ENV DEBIAN_FRONTEND=noninteractive

RUN apt-get update && apt-get install -y \
    libglib2.0-0 \
    libsm6 \
    libxrender1 \
    libxext6 \
    libgl1 \
    bash && \
    rm -rf /var/lib/apt/lists/*

WORKDIR /app

COPY . /app

RUN pip install --upgrade pip && \
    pip install --no-cache-dir --no-index --find-links=/app/wheels /app/wheels/*.whl && \
    rm -rf /app/wheels

CMD ["bash"]





# FROM python:3.10-slim AS builder
# ENV DEBIAN_FRONTEND=noninteractive

# RUN apt-get update && apt-get install -y \
#     build-essential \
#     git \
#     curl \
#     wget \
#     ca-certificates \
#     libglib2.0-0 \
#     libsm6 \
#     libxrender1 \
#     libxext6 \
#     bash \
#     libgl1 && \
#     curl -sS https://bootstrap.pypa.io/get-pip.py | python3.10 && \
#     rm -rf /var/lib/apt/lists/*

# WORKDIR /app

# COPY ./wheels /app/wheels

# RUN pip install --upgrade pip && \
#     pip install --no-cache-dir --no-index --find-links=wheels wheels/*.whl && \
#     rm -rf wheels



# FROM python:3.10-slim AS final
# ENV DEBIAN_FRONTEND=noninteractive

# RUN apt-get update && apt-get install -y \
#     libglib2.0-0 \
#     libsm6 \
#     libxrender1 \
#     libxext6 \
#     libgl1 \
#     bash && \
#     rm -rf /var/lib/apt/lists/*

# WORKDIR /app

# COPY --from=builder /usr/local /usr/local

# COPY . /app

# RUN rm -rf wheels


# CMD ["/bin/bash"]
